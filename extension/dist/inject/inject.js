(()=>{var ce=Object.create,O=Object.defineProperty,Ae=Object.getPrototypeOf,ue=Object.prototype.hasOwnProperty,fe=Object.getOwnPropertyNames,de=Object.getOwnPropertyDescriptor;var xe=e=>O(e,"__esModule",{value:!0});var pe=(e,r)=>()=>(r||(r={exports:{}},e(r.exports,r)),r.exports);var he=(e,r,s)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of fe(r))!ue.call(e,o)&&o!=="default"&&O(e,o,{get:()=>r[o],enumerable:!(s=de(r,o))||s.enumerable});return e},be=e=>e&&e.__esModule?e:he(xe(O(e!=null?ce(Ae(e)):{},"default",{value:e,enumerable:!0})),e);var Q=pe(($,J)=>{(function(e,r){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],r);else if(typeof $!="undefined")r(J);else{var s={exports:{}};r(s),e.browser=s.exports}})(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:$,function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser=="undefined"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){let r="The message port closed before a response was received.",s=o=>{let g={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(g).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class m extends WeakMap{constructor(t,l=void 0){super(l);this.createItem=t}get(t){return this.has(t)||this.set(t,this.createItem(t)),super.get(t)}}let i=n=>n&&typeof n=="object"&&typeof n.then=="function",h=(n,t)=>(...l)=>{o.runtime.lastError?n.reject(new Error(o.runtime.lastError.message)):t.singleCallbackArg||l.length<=1&&t.singleCallbackArg!==!1?n.resolve(l[0]):n.resolve(l)},b=n=>n==1?"argument":"arguments",v=(n,t)=>function(c,...u){if(u.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${b(t.minArgs)} for ${n}(), got ${u.length}`);if(u.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${b(t.maxArgs)} for ${n}(), got ${u.length}`);return new Promise((d,x)=>{if(t.fallbackToNoCallback)try{c[n](...u,h({resolve:d,reject:x},t))}catch(a){console.warn(`${n} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,a),c[n](...u),t.fallbackToNoCallback=!1,t.noCallback=!0,d()}else t.noCallback?(c[n](...u),d()):c[n](...u,h({resolve:d,reject:x},t))})},I=(n,t,l)=>new Proxy(t,{apply(c,u,d){return l.call(u,n,...d)}}),P=Function.call.bind(Object.prototype.hasOwnProperty),T=(n,t={},l={})=>{let c=Object.create(null),u={has(x,a){return a in n||a in c},get(x,a,p){if(a in c)return c[a];if(!(a in n))return;let A=n[a];if(typeof A=="function")if(typeof t[a]=="function")A=I(n,n[a],t[a]);else if(P(l,a)){let y=v(a,l[a]);A=I(n,n[a],y)}else A=A.bind(n);else if(typeof A=="object"&&A!==null&&(P(t,a)||P(l,a)))A=T(A,t[a],l[a]);else if(P(l,"*"))A=T(A,t[a],l["*"]);else return Object.defineProperty(c,a,{configurable:!0,enumerable:!0,get(){return n[a]},set(y){n[a]=y}}),A;return c[a]=A,A},set(x,a,p,A){return a in c?c[a]=p:n[a]=p,!0},defineProperty(x,a,p){return Reflect.defineProperty(c,a,p)},deleteProperty(x,a){return Reflect.deleteProperty(c,a)}},d=Object.create(n);return new Proxy(d,u)},_=n=>({addListener(t,l,...c){t.addListener(n.get(l),...c)},hasListener(t,l){return t.hasListener(n.get(l))},removeListener(t,l){t.removeListener(n.get(l))}}),ge=new m(n=>typeof n!="function"?n:function(l){let c=T(l,{},{getContent:{minArgs:0,maxArgs:0}});n(c)}),U=new m(n=>typeof n!="function"?n:function(l,c,u){let d=!1,x,a=new Promise(S=>{x=function(w){d=!0,S(w)}}),p;try{p=n(l,c,x)}catch(S){p=Promise.reject(S)}let A=p!==!0&&i(p);if(p!==!0&&!A&&!d)return!1;let y=S=>{S.then(w=>{u(w)},w=>{let F;w&&(w instanceof Error||typeof w.message=="string")?F=w.message:F="An unexpected error occurred",u({__mozWebExtensionPolyfillReject__:!0,message:F})}).catch(w=>{console.error("Failed to send onMessage rejected reply",w)})};return y(A?p:a),!0}),le=({reject:n,resolve:t},l)=>{o.runtime.lastError?o.runtime.lastError.message===r?t():n(new Error(o.runtime.lastError.message)):l&&l.__mozWebExtensionPolyfillReject__?n(new Error(l.message)):t(l)},W=(n,t,l,...c)=>{if(c.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${b(t.minArgs)} for ${n}(), got ${c.length}`);if(c.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${b(t.maxArgs)} for ${n}(), got ${c.length}`);return new Promise((u,d)=>{let x=le.bind(null,{resolve:u,reject:d});c.push(x),l.sendMessage(...c)})},me={devtools:{network:{onRequestFinished:_(ge)}},runtime:{onMessage:_(U),onMessageExternal:_(U),sendMessage:W.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:W.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},D={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return g.privacy={network:{"*":D},services:{"*":D},websites:{"*":D}},T(o,me,g)};e.exports=s(chrome)}else e.exports=globalThis.browser})});function j(e,r){for(var s=0,o=e.length;s<o;s++)if(!r(e[s],s,e))return!1;return!0}"use strict";var k="/",R=0,H=1,V=2,B=3,q=47,we=58,ke=42,Ee=63;function z(e){if(e===k)return e;e.charCodeAt(0)===q&&(e=e.substring(1));var r=e.length-1;return e.charCodeAt(r)===q?e.substring(0,r):e}function G(e){return(e=z(e))===k?[k]:e.split(k)}function Y(e,r,s){return s=e[s],r.val===s&&r.type===R||(s===k?r.type>H:r.type!==R&&(s||"").endsWith(r.end))}function K(e,r){for(var s=0,o,g=G(e),m=g.length,i,h=Y.bind(Y,g);s<r.length;s++)if(o=r[s],((i=o.length)===m||i<m&&o[i-1].type===V||i>m&&o[i-1].type===B)&&j(o,h))return o;return[]}function E(e){if(e===k)return[{old:e,type:R,val:e,end:""}];for(var r,s,o,g,m=z(e),i=-1,h=0,b=m.length,v=[];++i<b;)if(r=m.charCodeAt(i),r===we){for(h=i+1,o=H,s=0,g="";i<b&&m.charCodeAt(i)!==q;)r=m.charCodeAt(i),r===Ee?(s=i,o=B):r===46&&g.length===0&&(g=m.substring(s=i)),i++;v.push({old:e,type:o,val:m.substring(h,s||i),end:g}),m=m.substring(i),b-=i,i=0;continue}else if(r===ke){v.push({old:e,type:V,val:m.substring(i),end:""});continue}else{for(h=i;i<b&&m.charCodeAt(i)!==q;)++i;v.push({old:e,type:R,val:m.substring(h,i),end:""}),m=m.substring(i),b-=i,i=h=0}return v}function Z(e,r){for(var s=0,o,g,m=G(e),i={};s<r.length;s++)o=m[s],g=r[s],o!==k&&o!==void 0&&g.type|B===2&&(i[g.val]=o.replace(g.end,""));return i}var M=be(Q()),f;(function(e){e[e.root=0]="root",e[e.rootFile=1]="rootFile",e[e.rootTree=2]="rootTree",e[e.folder=3]="folder",e[e.file=4]="file",e[e.pullRequestFiles=5]="pullRequestFiles"})(f||(f={}));var X="popups/private-repo-instructions";function ee(){let e=!!document.querySelector("h1 > .octicon-lock")||!!document.querySelector("header .octicon-lock");return console.debug("[peek]",{isPrivate:e}),e}async function ve(){return!!await M.default.storage.sync.get(X)}async function ye(){return await M.default.storage.sync.set({[X]:!0})}var Ce=`
<svg
  aria-hidden="true"
  focusable="false"
  height=18
  width=12
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 384 512"
  class="icon-peek"
>
  <path
    fill="currentColor"
    d="M186.1.09C81.01 3.24 0 94.92 0 200.05v263.92c0 14.26 17.23 21.39 27.31 11.31l24.92-18.53c6.66-4.95 16-3.99 21.51 2.21l42.95 48.35c6.25 6.25 16.38 6.25 22.63 0l40.72-45.85c6.37-7.17 17.56-7.17 23.92 0l40.72 45.85c6.25 6.25 16.38 6.25 22.63 0l42.95-48.35c5.51-6.2 14.85-7.17 21.51-2.21l24.92 18.53c10.08 10.08 27.31 2.94 27.31-11.31V192C384 84 294.83-3.17 186.1.09zM128 224c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32zm128 0c-17.67 0-32-14.33-32-32s14.33-32 32-32 32 14.33 32 32-14.33 32-32 32z"
    class=""
  ></path>
</svg>`,re=new WeakMap;async function L(e){if(e.innerHTML=`
    ${Ce}
    <span class="btn-peek-title">${Se}</span>
  `,!ee())return;let r=e.getAttribute("href");r.includes("?")?r.includes("noCDN")||(r+="&noCDN",e.setAttribute("href",r)):(r+="?noCDN",e.setAttribute("href",r)),!(re.has(e)||N)&&(re.set(e,!0),e.addEventListener("click",Pe,{once:!0,passive:!0}))}var se=E("/:owner/:repo"),ne=E("/:owner/:repo/tree/:ref"),te=E("/:owner/:repo/tree/:ref/*"),ie=E("/:owner/:repo/blob/:ref/:filename"),oe=E("/:owner/:repo/blob/:ref/*"),ae=E("/:owner/:repo/pull/:pullRequestID/files"),Te=[se,ne,te,ae,ie,oe];function C(){let e=K(location.pathname,Te),r;switch(e){case se:{r=0;break}case ne:{r=2;break}case oe:case te:{r=4,document.querySelector("#files")&&(r=3);break}case ie:{r=1,document.querySelector("#files")&&(r=3);break}case ae:{r=5;break}}let s=Z(location.pathname,e);s.path=s["*"],delete s["*"],Re(r,s)}var Se="Peek",N=!1,qe="https://github.com/Jarred-Sumner/1-click-from-github-to-editor/blob/main/PRIVATE-REPOSITORIES.md#L1";async function Pe(){!ee()||N||(await ve()&&(window.open(qe,"_blank"),await ye(),N=!0),N=!0)}function Re(e,r){switch(e){case 2:case 0:{if(e===0){let m=document.querySelector("#branch-select-menu .btn .css-truncate-target"),i=m?.textContent;console.debug("[peek]",{branchText:m,ref:i}),i&&(r.ref=i)}let g=document.querySelector(".file-navigation get-repo")||document.querySelector("#\\:r5\\:");if(console.debug("[peek]",{repoOpenButton:g}),g&&!document.querySelector(".DEDUPE_git-peek-repo")){console.debug("[peek] adding button");var s=document.createElement("a");s.className="btn DEDUPE_git-peek-repo btn-peek btn-peek--spaced",r.ref?s.href="git-peek://"+location.origin+`/${r.owner}/${r.repo}/tree/${r.ref}`:s.href="git-peek://"+location.origin+location.pathname,L(s),g.parentElement.insertBefore(s,g)}break}case 3:{let g=document.querySelector('.btn[data-hotkey="t"]');if(g&&!document.querySelector(".DEDUPE_git-peek-repo")){var s=document.createElement("a");s.className="btn DEDUPE_git-peek-repo btn-peek",r.ref?s.href="git-peek://"+location.origin+`/${r.owner}/${r.repo}/tree/${r.ref}`:s.href="git-peek://"+location.origin+location.pathname,s.style.marginRight="8px",L(s),g.parentElement.insertBefore(s,g)}break}case 1:case 4:{let g=document.querySelector(".BtnGroup");if(g&&!document.querySelector(".DEDUPE_git-peek-file")){var o=document.createElement("div");o.className="BtnGroup";var s=document.createElement("a");s.className="btn btn-sm DEDUPE_git-peek-file btn-peek",s.href="git-peek://"+window.location.href,s.style.marginRight="8px",o.appendChild(s),L(s),g.parentElement.prepend(o)}break}case 5:{for(let g of document.querySelectorAll(".file-header")){let m;g.querySelector(".octicon.octicon-file")?m=g.querySelector(".octicon.octicon-file").closest(".BtnGroup"):m=g.querySelector(".js-toggle-user-reviewed-file-form");let i=g.querySelector('*[data-ga-click="View file, click, location:files_changed_dropdown"]')?.getAttribute("href");if(m&&i&&!g.querySelector(".DEDUPE_git-peek-fileaction")){var o=document.createElement("div");o.className="BtnGroup";var s=document.createElement("a");s.className="btn btn-sm DEDUPE_git-peek-fileaction btn-peek",i.startsWith("/")&&(i=location.origin+i),s.href="git-peek://"+i,s.style.marginRight="8px",o.appendChild(s),L(s),m.parentElement.prepend(o)}}break}}}window.addEventListener("DOMContentLoaded",()=>requestAnimationFrame(C));window.addEventListener("popstate",()=>requestAnimationFrame(C));window.addEventListener("replaceState",()=>requestAnimationFrame(C));requestAnimationFrame(C);setTimeout(C,100);M.default.runtime.onMessage.addListener(()=>{requestAnimationFrame(C)});})();
